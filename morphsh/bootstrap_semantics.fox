# bootstrap_semantics.fox - Test semantic analysis
ambil "io"

fungsi main() void
    io.Write("=== BOOTSTRAP TYPE CHECKER TEST ===\n")
    
    var checker = checker_new()
    
    # Test 1: int + int -> int
    var int_type = make_int_type()
    var result1 = check_binary_expr(checker, int_type, "+", int_type)
    jika result1.kind == KIND_INT
        io.Write("âœ… int + int -> int: PASS\n")
    lainnya
        io.Write("âŒ int + int -> int: FAIL\n")
    akhir
    
    # Test 2: string + string -> string  
    var string_type = make_string_type()
    var result2 = check_binary_expr(checker, string_type, "+", string_type)
    jika result2.kind == KIND_STRING
        io.Write("âœ… string + string -> string: PASS\n")
    lainnya
        io.Write("âŒ string + string -> string: FAIL\n")
    akhir
    
    # Test 3: int + string -> error
    var result3 = check_binary_expr(checker, int_type, "+", string_type)
    jika result3.kind == KIND_ERROR
        io.Write("âœ… int + string -> error: PASS\n")
    lainnya
        io.Write("âŒ int + string -> error: FAIL\n")
    akhir
    
    # Test 4: int == int -> bool
    var result4 = check_binary_expr(checker, int_type, "==", int_type)
    jika result4.kind == KIND_BOOL
        io.Write("âœ… int == int -> bool: PASS\n")
    lainnya
        io.Write("âŒ int == int -> bool: FAIL\n")
    akhir
    
    # Test 5: Assignment compatibility
    var bool_type = make_bool_type()
    var assign_ok = check_assignment(checker, int_type, int_type)
    jika assign_ok
        io.Write("âœ… int = int: PASS\n")
    lainnya
        io.Write("âŒ int = int: FAIL\n")
    akhir
    
    var assign_fail = check_assignment(checker, int_type, string_type)
    jika assign_fail == salah
        io.Write("âœ… int = string (rejected): PASS\n")
    lainnya
        io.Write("âŒ int = string (rejected): FAIL\n")
    akhir
    
    # Test 6: Built-in functions
    var len_result = check_function_call(checker, "len")
    jika len_result.kind == KIND_INT
        io.Write("âœ… len() -> int: PASS\n")
    lainnya
        io.Write("âŒ len() -> int: FAIL\n")
    akhir
    
    jika checker.has_errors
        io.Write("\nâš ï¸  Checker detected errors (expected for negative tests)\n")
    akhir
    
    io.Write("\nğŸ¯ BOOTSTRAP SEMANTIC ANALYSIS COMPLETE!\n")
    io.Write("âœ… Go-compatible type rules\n")
    io.Write("âœ… Assignment compatibility\n") 
    io.Write("âœ… Binary expression checking\n")
    io.Write("âœ… Built-in function validation\n")
akhir
